<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Crypto-Electron</title>
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <script src="js/hashGrid.js"></script>
    <script src="js/aes.js"></script>

  </head>
  <body>
      <div id="formBody" class="row">
          <div class="col-sm-6" >
              <h3 class="appHeader">1. Draw a pattern</h3>
              <canvas id="mainGrid">You're browser does not support HTML5.</canvas>
               <div class="input-group mb-3 topPad">
                   <div class="input-group-prepend">
                     <div class="input-group-text">
                       <input type="checkbox" id="hidePatternCheckBox">
                     </div>
                     <span class="form-control input-type-text" ><strong>Hide Pattern</strong></span>
                   </div>
                   
                 <button type="button" class="btn btn-sm btn-outline-primary" onclick="clearButtonClick()">Clear</button>
               </div>
          </div>
          <div class="col-sm-6" >
              <h3 class="appHeader">2. Select source file (cleartext)</h3>
              <div class="topPad">
                <button class="btn btn-sm btn-outline-primary" onclick="ipc.send('open-file-dialog')">Select File</button>
                <div id="selected-file"></div>
              </div>
              <div class="topPad">
                <h3 class="appHeader">3. Select target file (encrypted)</h3>
                <button class="btn btn-sm btn-outline-primary" onclick="ipc.send('open-save-dialog')">Save File</button>
                <div id="saved-file"></div>
              </div>
              <form class="form-inline">
                <div class="input-group">
                  <label class="input-group-addon"><input id="addUppercaseCheckBox" type="checkbox" value=""><strong> Add UpperCase</strong></label>
                  <label id="noshow" class="form-control" ></label>
                </div>
                <div class="input-group">
                  <label class="input-group-addon"><input id="addSpecialCharsCheckBox" type="checkbox" value=""><strong> Add Special Chars</strong></label>
                  <input class="form-control" id="specialChars" placeholder="special chars">
                </div>
                <div class="input-group">
                  <label class="input-group-addon"><input id="maxLengthCheckBox" type="checkbox" value=""><strong> Max Length</strong></label>
                  <input type = "number" max="64" min="0" class="form-control" id="maxLength" value="32">
                </div>
              </form>
          </div>
        </div>
       </div>
      </div>
       <script src="js/sha256.js"></script>
    <div>
    We are using Node.js <span id="node-version"></span>,
    Chromium <span id="chrome-version"></span>,
    and Electron <span id="electron-version"></span>.
    </div>
    
    <div id="encrypted">
    </div>
    <div id="decrypted">
    </div>
    <div class="form-group">
    <select id="specialFolders" class="form-control">
        <option value="appData">appData</option>
        <option value="desktop">Desktop</option>
        <option value="documents">Documents</option>
        <option value="downloads">Downloads</option>
        <option value="home">Home</option>
        <option value="music">Music</option>
        <option value="pictures">Pictures</option>
        <option value="temp">Temp</option>
        <option value="userData">userData</option>
        <option value="videos">Videos</option>
      </select>
    </div>
    <h5 id="appsRootPath">placeholder</h5>
    <div id="formBody" class="row">
        <div class="col-sm-8" >
          <select id="PathListBox" 
            class="RadListBox form-control" 
            size="5">
          </select>
        </div>
    </div>
    <h5 id="sourcePath"></h5>
    <div id="formBody" class="row">
      <div class="col-sm-8" >
      <select id="FileListBox" 
        class="RadListBox form-control" 
        size="5">
      </select>
      <button onclick="readFile()"class="btn btn-sm btn-outline-primary">Encrypt</button>
      <button onclick="getFileList()"class="btn btn-sm btn-outline-primary">List Files</button>
      <button onclick="alert('not connected to anything!')"class="btn btn-sm btn-outline-primary">Get Dirs</button>
      </div>
    </div>
    <script>
        var plainText = "This is a an extremely long message <strong> with </strong> CRLF \n and other items in it.";
        var key = CryptoJS.enc.Hex.parse('76CE9BBA9487266738E3C4F0B3CFA4BE0C0EBA52ED1C3C425E06900442EFE5E1'); 
        var iv = CryptoJS.enc.Hex.parse('76CE9BBA9487266738E3C4F0B3CFA4BE'); 
        var encrypted = CryptoJS.AES.encrypt(plainText, key, { iv: iv }); 
        //var encrypted = CryptoJS.AES.encrypt(plainText, "Secret"); 
        //var cipherText = CryptoJS.enc.Hex.parse(String(encrypted.ciphertext));
        //console.log("cipherText : " + cipherText);
        document.getElementById("encrypted").innerHTML = encrypted;
        var decrypted = CryptoJS.AES.decrypt(encrypted,  key, { iv: iv });
        //var decrypted = CryptoJS.AES.decrypt(encrypted, "Secret");
        console.log("decrypted: " + decrypted.toString());
        let plainTextOut = decodeHexString(decrypted.toString());
        console.log(plainTextOut);
        document.getElementById("decrypted").innerHTML = plainTextOut; 
        function decodeHexString(stringOfHexBytes){
            var localPlainText = "";
            var currentByte = "";
            for (var x = 0;x < stringOfHexBytes.length;x++){
             currentByte = stringOfHexBytes[x] + stringOfHexBytes[++x]; 
             localPlainText += String.fromCharCode(parseInt(currentByte,16));
            }
        return localPlainText;
        }
    </script>

    <!-- You can also require other files to run in this process -->
    <script src="./renderer.js"></script>
  </body>
</html>
